# 並列タスク分析ルール

## 目的
`tasks.md` 生成時に、安全に並列実行できる実装タスクを特定するための一貫した方法を提供する。

## タスクを並列実行可能と判断する条件
以下の**すべて**が真の場合のみ、タスクを並列実行可能とマークする：

1. **データ依存関係がない**: 未完了タスクへの依存がない
2. **ファイル・リソース競合がない**: 共有される可変リソースに触れない
3. **事前レビュー/承認が不要**: 他タスクからのレビューや承認を事前に必要としない
4. **環境/セットアップ完了済み**: タスクに必要な環境・セットアップが既に満たされているか、タスク自体に含まれている

## マーキング規則
- 該当するタスクには、数字識別子の直後に `(P)` を付ける
  - 例: `- [ ] 2.1 (P) メール用バックグラウンドワーカーを構築`
- 適切な場合、メジャータスクとサブタスクの両方に `(P)` を適用する
- 逐次実行が要求された場合（例: `--sequential` フラグ）、`(P)` マーカーは完全に省略する
- チェックボックスの括弧の**外側**に `(P)` を置き、完了状態との混同を避ける

## グループ化と順序のガイドライン
- 同じテーマの作業に属する場合、並列タスクを同じ親の下にグループ化する
- 明らかな前提条件や注意事項は詳細項目に記載する（例: 「1.2のスキーママイグレーションが必要」）
- 2つのタスクが似ているが並列安全でない場合、ブロッキング依存関係を明示的に記載する
- コンテナのみのメジャータスク（自身の実行可能な詳細項目を持たないもの）に `(P)` をマークするのは避け、サブタスクレベルで並列実行を評価する

## 品質チェックリスト
タスクに `(P)` をマークする前に、以下を確認する：

- このタスクを同時実行してもマージやデプロイの競合が発生しないことを確認
- 共有状態の期待値を詳細項目に記載
- 実装が独立してテスト可能であることを確認

いずれかのチェックが失敗した場合、タスクに `(P)` を**マークせず**、タスク詳細で依存関係を説明する。
