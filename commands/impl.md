<meta>
description: TDD手法を使用してspecタスクを実行
argument-hint: <feature-name:$1> [task-numbers:$2]
</meta>

# 実装タスク実行

<background_information>
- **ミッション**: 承認済み仕様に基づいて、テスト駆動開発手法を使用して実装タスクを実行
- **成功基準**:
  - すべてのテストを実装コードより先に記述
  - コードがすべてのテストに合格しリグレッションなし
  - タスクが tasks.md で完了としてマーク
  - 実装が設計と要件に整合
</background_information>

<instructions>
## コアタスク
テスト駆動開発を使用して、機能 **$1** の実装タスクを実行する。

## 実行ステップ

### ステップ1: コンテキストの読み込み

**必要なすべてのコンテキストを読み込み**:
- `.cursor/$1/spec.json`、`requirements.md`、`design.md`、`tasks.md`
- `.cursor/rules/frontend.md`（存在する場合）からフロントエンド実装ルール

**承認の検証**:
- spec.json でタスクが承認されていることを確認（されていない場合は停止、安全性とフォールバック参照）

### ステップ2: タスクの選択

**実行するタスクを決定**:
- `$2` が提供された場合: 指定されたタスク番号を実行（例: "1.1" または "1,2,3"）
- それ以外: すべての保留タスクを実行（tasks.md で未チェック `- [ ]`）

### ステップ3: TDDで実行

選択された各タスクについて、Kent BeckのTDDサイクルに従う:

1. **RED - 失敗するテストを書く**:
   - 次の小さな機能のテストを書く
   - テストは失敗するはず（コードがまだ存在しない）
   - 説明的なテスト名を使用

2. **GREEN - 最小限のコードを書く**:
   - テストを通過させる最もシンプルなソリューションを実装
   - このテストを通過させることだけにフォーカス
   - オーバーエンジニアリングを避ける

3. **REFACTOR - クリーンアップ**:
   - コード構造と可読性を改善
   - 重複を削除
   - 適切な箇所にデザインパターンを適用
   - リファクタリング後もすべてのテストが通過することを確認

4. **VERIFY - 品質を検証**:
   - すべてのテストが通過（新規と既存）
   - 既存機能にリグレッションなし
   - コードカバレッジを維持または改善

5. **完了マーク**:
   - tasks.md でチェックボックスを `- [ ]` から `- [x]` に更新

## 重要な制約
- **TDD必須**: テストは実装コードより先に書かなければならない
- **タスクスコープ**: 特定のタスクが要求するものだけを実装
- **テストカバレッジ**: すべての新しいコードにテストが必要
- **リグレッションなし**: 既存のテストは引き続き通過しなければならない
- **設計整合性**: 実装は design.md 仕様に従わなければならない
</instructions>

## ツールガイダンス
- **最初に読み込み**: 実装前にすべてのコンテキストを読み込み
- **テストファースト**: コードより先にテストを書く
- 必要に応じてライブラリドキュメントのため **WebSearch/WebFetch** を使用

## 出力説明

spec.json で指定された言語で簡潔なサマリーを提供:

1. **実行されたタスク**: タスク番号とテスト結果
2. **ステータス**: 完了タスクが tasks.md でマーク、残りのタスク数

**フォーマット**: 簡潔（150語以内）

## 安全性とフォールバック

### エラーシナリオ

**タスクが未承認またはSpecファイルが見つからない**:
- **実行停止**: すべてのspecファイルが存在し、タスクが承認されていなければならない
- **提案アクション**: "前のフェーズを完了してください: `/requirements`、`/design`、`/tasks`"

**テスト失敗**:
- **実装停止**: 続行前に失敗したテストを修正
- **アクション**: デバッグして修正、その後再実行

### タスク実行

**特定のタスクを実行**:
- `/impl $1 1.1` - 単一タスク
- `/impl $1 1,2,3` - 複数タスク

**すべての保留タスクを実行**:
- `/impl $1` - すべての未チェックタスク

</output>
